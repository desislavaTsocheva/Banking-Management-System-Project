@page
@model BankingManagmentApp.Areas.Identity.Pages.Account.Manage.AppearanceModel
@{
    ViewData["Title"] = "Appearance";
    ViewData["ActivePage"] = ManageNavPages.Appearance;
}

<h4 class="mb-4">Appearance</h4>
<partial name="_StatusMessage" for="StatusMessage" />

<div class="row">
    <div class="col-12 col-lg-8">
        <div class="card shadow-sm border-0">
            <div class="card-body p-4">
                <form method="post" id="appearance-form">
                    <fieldset>
                        <legend class="h6 mb-3">Theme</legend>

                        <div class="btn-group" role="group" aria-label="Theme selection">
                            <input type="radio" class="btn-check" name="Input.Mode" id="modeLight" value="light"
                                   @(Model.Input?.Mode == "light" ? "checked" : "")>
                            <label class="btn btn-outline-primary" for="modeLight">Light</label>

                            <input type="radio" class="btn-check" name="Input.Mode" id="modeDark" value="dark"
                                   @(Model.Input?.Mode == "dark" ? "checked" : "")>
                            <label class="btn btn-outline-primary" for="modeDark">Dark</label>

                            <input type="radio" class="btn-check" name="Input.Mode" id="modeSystem" value="system"
                                   @(Model.Input?.Mode == "system" ? "checked" : "")>
                            <label class="btn btn-outline-primary" for="modeSystem">System</label>
                        </div>
                    </fieldset>

                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary">Save preference</button>
                    </div>
                </form>

                <hr class="my-4"/>

                <div class="small text-body-secondary">
                    <strong>Tip:</strong> "System" follows the operating system setting.
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
  // Live preview при избор (без презареждане)
  const radios = document.querySelectorAll('input[name="Input.Mode"]');
  function apply(mode) {
    const actual = mode === 'system'
      ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
      : mode;
    document.documentElement.setAttribute('data-bs-theme', actual);
    document.documentElement.classList.toggle('dark', actual === 'dark');
  }
  radios.forEach(r => r.addEventListener('change', e => apply(e.target.value)));
</script>
}
